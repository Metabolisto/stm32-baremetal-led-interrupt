# STM32: —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã –∏ –≤–Ω–µ—à–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –≤–Ω–µ—à–Ω–µ–≥–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è EXTI —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ (–±–µ–∑ HAL) –Ω–∞ –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ STM32F103C8T6. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –º–∏–≥–∞–Ω–∏–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤.

## üß© –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞  

- **MCU**: STM32F103C8T6 ("Blue Pill")  
- **IDE**: STM32CubeIDE 1.17.0  
- **–Ø–∑—ã–∫**: C (–±–µ–∑ HAL, —Ç–æ–ª—å–∫–æ CMSIS + –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞–º)  
- **Toolchain**: arm-none-eabi-gcc + Makefile (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è IDE)  

## ‚öôÔ∏è –û–ø–∏—Å–∞–Ω–∏–µ

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω–µ—à–Ω–µ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ EXTI0 –æ—Ç –∫–Ω–æ–ø–∫–∏ –Ω–∞ PA0.  
- –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞–º–∏ –Ω–∞ `GPIO`.  
- –†–∞–±–æ—Ç–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ **–±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è HAL**, —Ç–æ–ª—å–∫–æ CMSIS –∏ –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞–º.  
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑:  
  - EXTI ‚Äî –ª–∏–Ω–∏–∏ –≤–Ω–µ—à–Ω–∏—Ö –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
  - AFIO ‚Äî –º—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–æ—Ä –ª–∏–Ω–∏–π EXTI
  - NVIC ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
GPIOx_CRL, GPIOx_ODR ‚Äî –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º
- –ù–∏–∫–∞–∫–∏—Ö HAL –∏–ª–∏ SPL ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π CMSIS –∏ —Ä–µ–≥–∏—Å—Ç—Ä—ã STM32.

## üìÑ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã STM32F1
AFIO->EXTICR1 ‚Äî –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ª–∏–Ω–∏–∏ EXTI0 –∫ PA0

EXTI->IMR / FTSR / PR ‚Äî –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–ø–∞–¥–∞—é—â–∏–π —Ñ—Ä–æ–Ω—Ç, –æ—á–∏—Å—Ç–∫–∞ —Ñ–ª–∞–≥–∞

NVIC_EnableIRQ(EXTI0_IRQn) ‚Äî —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ

GPIOx_CRL / GPIOx_ODR ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞–º–∏

## üñß –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è

| –ü–∏–Ω | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                         |
|-----|------------------------------------|
|PA0  | –í—Ö–æ–¥ –∫–Ω–æ–ø–∫–∏ / —Å–∏–≥–Ω–∞–ª –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è    |
|PBx  | –°–≤–µ—Ç–æ–¥–∏–æ–¥—ã (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –≤ main.c)|

(–í –ø—Ä–æ–µ–∫—Ç–µ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ø–∏–Ω—ã –≤ –º–∞—Å—Å–∏–≤–µ led_pins.)

–ü—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ LED:
GPIO (PBx) ‚îÄ‚îÄ‚îÄ‚ñ∫|‚îÄ‚îÄ‚îÄ/\/\/‚îÄ‚îÄ‚îÄ GND
              LED   330Œ©
–ü—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã –∫–Ω–æ–ø–∫–∏ —Å Pull-up:
VCC (3.3V)
   ‚îÇ
  [10kŒ©]
   ‚îÇ
  PA0 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ
          [–ö–Ω–æ–ø–∫–∞]
            ‚îÇ
           GND
 - –ö–Ω–æ–ø–∫–∞ (–Ω–∞ PA0)
–†–µ–∑–∏—Å—Ç–æ—Ä –ø–æ–¥—Ç—è–∂–∫–∏ (Pull-up):
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–∑–∏—Å—Ç–æ—Ä 10 –∫–û–º –º–µ–∂–¥—É PA0 –∏ VCC (3.3 –í), –µ—Å–ª–∏ –Ω–µ –≤–∫–ª—é—á—ë–Ω –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Pull-up.
–ö–Ω–æ–ø–∫–∞ –¥–æ–ª–∂–Ω–∞ –∑–∞–º—ã–∫–∞—Ç—å PA0 –Ω–∞ GND –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ (–∞–∫—Ç–∏–≤–Ω—ã–π –Ω–∏–∑–∫–∏–π —Å–∏–≥–Ω–∞–ª).
 - –°–≤–µ—Ç–æ–¥–∏–æ–¥—ã (–Ω–∞ PBx, PAx)
–°–≤–µ—Ç–æ–¥–∏–æ–¥—ã –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –∞–Ω–æ–¥–æ–º –∫ –≤—ã–≤–æ–¥—É GPIO, –∫–∞—Ç–æ–¥–æ–º ‚Äî —á–µ—Ä–µ–∑ —Ç–æ–∫–æ–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π —Ä–µ–∑–∏—Å—Ç–æ—Ä –Ω–∞ GND.
–†–µ–∑–∏—Å—Ç–æ—Ä 220‚Äì330 –û–º –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö LED (5 –º–º).
GPIO –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–∞–∫ Push-Pull Output, –ª–æ–≥–∏—á–µ—Å–∫–∞—è 1 –ø–æ–¥–∞—ë—Ç—Å—è –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è (–∏–ª–∏ 0 ‚Äî –µ—Å–ª–∏ —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –Ω–∞–æ–±–æ—Ä–æ—Ç).
‚ö†Ô∏è –í–∞–∂–Ω–æ: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GPIO-–ø–∏–Ω—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—é—Ç—Å—è. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç–æ–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ ‚Äî ~20 –º–ê, —Å—É–º–º–∞—Ä–Ω—ã–π –Ω–∞ –ø–æ—Ä—Ç ‚Äî ~100 –º–ê.

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞  
```
LED_Sequence_Interrupt/
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ Inc/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.h                 # –û–±—ä—è–≤–ª–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π, –º–∞–∫—Ä–æ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.c                 # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ system_stm32f10x.c     # –°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (CMSIS)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sysmem.c               # _sbrk –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ malloc (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ IDE)
‚îú‚îÄ‚îÄ Drivers/
‚îÇ   ‚îî‚îÄ‚îÄ CMSIS/
‚îÇ       ‚îî‚îÄ‚îÄ ...                    # Startup + CMSIS headers
‚îú‚îÄ‚îÄ Startup/
‚îÇ   ‚îî‚îÄ‚îÄ startup_stm32f103xb.s      # –í–µ–∫—Ç–æ—Ä –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –∏ Reset_Handler
‚îú‚îÄ‚îÄ STM32F103C8TX_FLASH.ld         # –õ–∏–Ω–∫–æ–≤–æ—á–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ .gitignore                     # –ò—Å–∫–ª—é—á–µ–Ω–∏—è Git
‚îú‚îÄ‚îÄ .project / .cproject           # –§–∞–π–ª—ã STM32CubeIDE
‚îî‚îÄ‚îÄ README.md                      # –û–ø–∏—Å–∞–Ω–∏–µ
```

## üß™ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ STM32CubeIDE.
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ STM32F103C8T6 –∫ –ü–ö (—á–µ—Ä–µ–∑ ST-Link).
3. –°–æ–±–µ—Ä–∏—Ç–µ –∏ –ø—Ä–æ—à–µ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç.
4. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–Ω–æ–ø–∫—É –∫ PA0 —Å –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—â–∏–º —Ä–µ–∑–∏—Å—Ç–æ—Ä–æ–º –∫ VCC (–∏–ª–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ GPIOx->ODR |= GPIO_ODR_ODR0).
5. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã –∞–Ω–æ–¥–∞–º–∏ –∫ –ø–∏–Ω–∞–º –ú–ö: PB11, PB10, PB1, PA7, PA6, PA5, PA4, PA3, PA2, PA1, PA0, PB9, PB8, PB7, PB6, PB5, PB4, PB3, PA15, PA12, PA11, PA10, PA9. –ê –∫–∞—Ç–æ–¥–∞–º–∏ —á–µ—Ä–µ–∑ —Ç–æ–∫–æ–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π —Ä–µ–∑–∏—Å—Ç–æ—Ä(~330–∫–û–º) –Ω–∞ GND.
6. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –∏ –Ω–∞–±–ª—é–¥–∞–π—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –º–∏–≥–∞–Ω–∏–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–æ–≤.

## ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏ —á–µ—Ä–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä—ã
- –ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –±–µ–∑ HAL.
- –ü—Ä–æ—Å—Ç–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å NVIC –∏ EXTI.
- –•–æ—Ä–æ—à–∞—è –æ—Å–Ω–æ–≤–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è bare-metal –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è STM32.

## –í–∏–¥–µ–æ –∏ –¥–æ–ø. –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- [–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã](https://youtube.com/shorts/FMx-e8y-4s4?feature=share)
- [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ST-LINK V2](https://github.com/user-attachments/assets/11cf20ef-1757-43f4-bd80-f0e9caa32841)
